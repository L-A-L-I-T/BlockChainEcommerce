{"ast":null,"code":"var _jsxFileName = \"/Users/lalit/Documents/BlockChain Development/blockchainEcommerce/client/src/components/App.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport { ethers } from \"ethers\";\nimport Ecommerce from \"../abis/Ecommerce.json\";\nimport Navbar from \"./Navbar/Navbar\";\nimport Products from \"./Products/Products\";\nimport \"./App.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction App() {\n  _s();\n\n  const [account, setAccount] = useState();\n  const [productCount, setProductCount] = useState(0);\n  const [products, setProducts] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [ecommerce, setEcommerce] = useState();\n  const [balance, setBalance] = useState();\n  const [refresh, setRefresh] = useState(false);\n\n  const toggleRefresh = () => setRefresh(!refresh);\n\n  const [toastShow, setToastShow] = useState(false);\n\n  const handleToastShowOpen = () => setToastShow(true);\n\n  const handleToastShowClose = () => {\n    setToastShow(false);\n    toggleRefresh();\n  };\n\n  const loadBlockChainData = async () => {\n    setProducts([]);\n\n    if (window.ethereum) {\n      const accounts = await window.ethereum.request({\n        method: \"eth_requestAccounts\"\n      });\n      setAccount(accounts[0]);\n      const networkId = await window.ethereum.request({\n        method: \"net_version\"\n      });\n      let balance = await window.ethereum.request({\n        method: \"eth_getBalance\",\n        params: [accounts[0], \"latest\"]\n      });\n      balance = ethers.utils.formatEther(balance);\n      setBalance(balance);\n      const provider = new ethers.providers.Web3Provider(window.ethereum);\n      const signer = provider.getSigner();\n      const networkData = Ecommerce.networks[networkId];\n\n      if (networkData) {\n        await loadContract(signer, networkData);\n      } else {\n        window.alert(\"Ecommerce contract not deployed to detected network\");\n      }\n    } else {\n      window.alert(\"Non-Ethereum browser detected. You should consider trying MetaMask!\");\n    }\n  };\n\n  const loadContract = async (signer, networkData) => {\n    setLoading(true);\n    const contract = new ethers.Contract(networkData.address, Ecommerce.abi, signer);\n    let temp = await contract.functions.productCount();\n    temp = temp.toString();\n    setProductCount(temp);\n    setEcommerce(contract);\n    setLoading(false);\n  };\n\n  const loadProducts = async () => {\n    console.log(productCount);\n\n    for (var i = 1; i <= productCount; i++) {\n      const product = await (ecommerce === null || ecommerce === void 0 ? void 0 : ecommerce.functions.products(i));\n      setProducts(products => [...products, product]);\n    }\n  };\n\n  useEffect(() => {\n    loadBlockChainData();\n  }, [refresh]);\n  useEffect(() => {\n    setProducts([]);\n    loadProducts();\n  }, [productCount]); // console.log(products);\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(ToastContainer, {\n      className: \"p-3\",\n      position: \"top-end\",\n      children: /*#__PURE__*/_jsxDEV(Toast, {\n        show: toastShow,\n        onClose: handleToastShowClose,\n        delay: 6000,\n        autohide: true,\n        children: /*#__PURE__*/_jsxDEV(Alert, {\n          variant: \"success\",\n          children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n            children: \"Product Purchased Successfully\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 96,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"It might take few minutes to reflect in our app\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 97,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Refresh if needed\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 98,\n            columnNumber: 7\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 6\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 5\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(Navbar, {\n      loading: loading,\n      account: account,\n      ecommerce: ecommerce,\n      setLoading: setLoading,\n      productCount: productCount,\n      toggleRefresh: toggleRefresh\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 4\n    }, this), loading && /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Loading....\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 16\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [\"Balance : \", balance]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [\"Product Count : \", productCount]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(Products, {\n      loading: loading,\n      products: products,\n      account: account,\n      ecommerce: ecommerce,\n      setLoading: setLoading,\n      handleToastShowOpen: handleToastShowOpen,\n      toggleRefresh: toggleRefresh\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 87,\n    columnNumber: 3\n  }, this);\n}\n\n_s(App, \"xbeTUoNDPwczv3M1AuNa7Csgkms=\");\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","ethers","Ecommerce","Navbar","Products","App","account","setAccount","productCount","setProductCount","products","setProducts","loading","setLoading","ecommerce","setEcommerce","balance","setBalance","refresh","setRefresh","toggleRefresh","toastShow","setToastShow","handleToastShowOpen","handleToastShowClose","loadBlockChainData","window","ethereum","accounts","request","method","networkId","params","utils","formatEther","provider","providers","Web3Provider","signer","getSigner","networkData","networks","loadContract","alert","contract","Contract","address","abi","temp","functions","toString","loadProducts","console","log","i","product"],"sources":["/Users/lalit/Documents/BlockChain Development/blockchainEcommerce/client/src/components/App.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { ethers } from \"ethers\";\nimport Ecommerce from \"../abis/Ecommerce.json\";\nimport Navbar from \"./Navbar/Navbar\";\nimport Products from \"./Products/Products\";\nimport \"./App.css\";\nfunction App() {\n\tconst [account, setAccount] = useState();\n\tconst [productCount, setProductCount] = useState(0);\n\tconst [products, setProducts] = useState([]);\n\tconst [loading, setLoading] = useState(true);\n\tconst [ecommerce, setEcommerce] = useState();\n\tconst [balance, setBalance] = useState();\n\tconst [refresh, setRefresh] = useState(false);\n\tconst toggleRefresh = () => setRefresh(!refresh);\n\tconst [toastShow, setToastShow] = useState(false);\n\tconst handleToastShowOpen = () => setToastShow(true);\n\tconst handleToastShowClose = () => {\n\t\tsetToastShow(false);\n\t\ttoggleRefresh();\n\t};\n\tconst loadBlockChainData = async () => {\n\t\tsetProducts([]);\n\t\tif (window.ethereum) {\n\t\t\tconst accounts = await window.ethereum.request({\n\t\t\t\tmethod: \"eth_requestAccounts\",\n\t\t\t});\n\t\t\tsetAccount(accounts[0]);\n\t\t\tconst networkId = await window.ethereum.request({\n\t\t\t\tmethod: \"net_version\",\n\t\t\t});\n\t\t\tlet balance = await window.ethereum.request({\n\t\t\t\tmethod: \"eth_getBalance\",\n\t\t\t\tparams: [accounts[0], \"latest\"],\n\t\t\t});\n\t\t\tbalance = ethers.utils.formatEther(balance);\n\t\t\tsetBalance(balance);\n\n\t\t\tconst provider = new ethers.providers.Web3Provider(window.ethereum);\n\t\t\tconst signer = provider.getSigner();\n\t\t\tconst networkData = Ecommerce.networks[networkId];\n\t\t\tif (networkData) {\n\t\t\t\tawait loadContract(signer, networkData);\n\t\t\t} else {\n\t\t\t\twindow.alert(\"Ecommerce contract not deployed to detected network\");\n\t\t\t}\n\t\t} else {\n\t\t\twindow.alert(\n\t\t\t\t\"Non-Ethereum browser detected. You should consider trying MetaMask!\"\n\t\t\t);\n\t\t}\n\t};\n\n\tconst loadContract = async (signer, networkData) => {\n\t\tsetLoading(true);\n\t\tconst contract = new ethers.Contract(\n\t\t\tnetworkData.address,\n\t\t\tEcommerce.abi,\n\t\t\tsigner\n\t\t);\n\t\tlet temp = await contract.functions.productCount();\n\t\ttemp = temp.toString();\n\t\tsetProductCount(temp);\n\t\tsetEcommerce(contract);\n\t\tsetLoading(false);\n\t};\n\n\tconst loadProducts = async () => {\n\t\tconsole.log(productCount);\n\t\tfor (var i = 1; i <= productCount; i++) {\n\t\t\tconst product = await ecommerce?.functions.products(i);\n\t\t\tsetProducts((products) => [...products, product]);\n\t\t}\n\t};\n\n\tuseEffect(() => {\n\t\tloadBlockChainData();\n\t}, [refresh]);\n\tuseEffect(() => {\n\t\tsetProducts([]);\n\t\tloadProducts();\n\t}, [productCount]);\n\n\t// console.log(products);\n\n\treturn (\n\t\t<div>\n\t\t\t<ToastContainer className=\"p-3\" position=\"top-end\">\n\t\t\t\t<Toast\n\t\t\t\t\tshow={toastShow}\n\t\t\t\t\tonClose={handleToastShowClose}\n\t\t\t\t\tdelay={6000}\n\t\t\t\t\tautohide\n\t\t\t\t>\n\t\t\t\t\t<Alert variant=\"success\">\n\t\t\t\t\t\t<h5>Product Purchased Successfully</h5>\n\t\t\t\t\t\t<p>It might take few minutes to reflect in our app</p>\n\t\t\t\t\t\t<p>Refresh if needed</p>\n\t\t\t\t\t</Alert>\n\t\t\t\t</Toast>\n\t\t\t</ToastContainer>\n\t\t\t<Navbar\n\t\t\t\tloading={loading}\n\t\t\t\taccount={account}\n\t\t\t\tecommerce={ecommerce}\n\t\t\t\tsetLoading={setLoading}\n\t\t\t\tproductCount={productCount}\n\t\t\t\ttoggleRefresh={toggleRefresh}\n\t\t\t/>\n\t\t\t{loading && <div>Loading....</div>}\n\t\t\t<div>Balance : {balance}</div>\n\t\t\t<div>Product Count : {productCount}</div>\n\t\t\t<Products\n\t\t\t\tloading={loading}\n\t\t\t\tproducts={products}\n\t\t\t\taccount={account}\n\t\t\t\tecommerce={ecommerce}\n\t\t\t\tsetLoading={setLoading}\n\t\t\t\thandleToastShowOpen={handleToastShowOpen}\n\t\t\t\ttoggleRefresh={toggleRefresh}\n\t\t\t/>\n\t\t</div>\n\t);\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}